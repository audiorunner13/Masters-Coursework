---
title: "HW Assignment 2 - Data605 Fall 2022 - Dr. Fulton"
author: "Peter Gatica"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE}
Sys.setenv(RGL_USE_NULL=TRUE)
library(matlib)
library(pracma)
library(tinytex)
library(matrixcalc)
```
$$
\text{ASSIGNMENT 2}
\\ \\
$$
$$
\text{IS 605 FUNDAMENTALS OF COMPUTATIONAL MATHEMATICS - 2015}
$$

Problem set 1

$$
(1)\ Show\  A^{t}A\neq AA^{t}\  in\  general.\ (Proof\ and\ demonstration.)
$$
$$
A\ = \ \begin{bmatrix}1&2&3\\ 4&5&6\end{bmatrix} \ A^{t}\  =\  \begin{bmatrix}1&2\\ 3&4\\ 5&6\end{bmatrix}
\\
\\
$$
$$
\\
\\
AA^{t} = \begin{bmatrix}1&2&3\\ 4&5&6\end{bmatrix} \begin{bmatrix}1&2\\ 3&4\\ 5&6\end{bmatrix} \ = \begin{bmatrix}35&44\\ 44&56\end{bmatrix} 
\\
\\
$$
$$
\text{Matrix multiplication results in a 2x2 matrix}
\\
\\
$$
$$
A^{t}A = \begin{bmatrix}1&2\\ 3&4\\ 5&6\end{bmatrix} \begin{bmatrix}1&2&3\\ 4&5&6\end{bmatrix} \ = \begin{bmatrix}5&11&17\\ 11&25&39\\ 17&39& 61\end{bmatrix} 
\\ 
\\ 
$$
$$
\text{Multiplication results in a 3x3 matrix}
$$
$$
(2)\ For\ a\ special\ type\ of\ square\ matrix\ A,\ we\ get\ A^{t}A\ =\ AA^{t}.\ Under\ what\ conditions\ could\ this\ be\ true?
$$
$$
\\
(Hint:\ The\ Identity\ matrix\ I\ is\ an\ example\ of\ such\ a\ matrix).
$$

$$
A\ = \ \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} \ A^{t}\  =\  \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix}
\\
\\
$$
$$
\\
\\
AA^{t} = \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} \ = \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} 
\\
\\
$$
$$
\\
\\
A^{t}A = \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} \ = \begin{bmatrix}1&0&0\\ 0&1&0\\ 0&0&1\\ \end{bmatrix} 
\\
\\
$$

Problem set 2

Matrix factorization is a very important problem. There are supercomputers built just to do matrix factorizations.
Every second you are on an airplane, matrices are being factorized. Radars that track flights use a technique called 
Kalman filtering. At the heart of Kalman Filtering is a Matrix Factorization operation. Kalman Filters are solving linear
systems of equations when they track your flight using radars. 

$$
A\ = \ \begin{bmatrix}1&1&2\\ 2&1&0\\ 3&1&1\\ \end{bmatrix}
$$
Calculate the Upper Triangular Matrix
$$
A\ = \ \begin{bmatrix}1&1&2\\ 2&1&0\\ 3&1&1\\ \end{bmatrix} \overrightarrow{-2R1+R2=R2} \ \begin{bmatrix}1&1&2\\ 0&-1&-4\\ 3&1&1\\ \end{bmatrix} \overrightarrow{-3R1+R3=R3} \ \begin{bmatrix}1&1&2\\ 0&-1&-4\\ 0&-2&5\\ \end{bmatrix} \overrightarrow{-2R2+R3=R3} \ \begin{bmatrix}1&1&2\\ 0&-1&-4\\ 0&0&3\\ \end{bmatrix} \ = U
$$
Take the inverse of the coefficients (-2,-3,-2) to calculate the Upper Truangular Matrix to get the Lower Triangular Matrix (L)

$$
L\ = \ \begin{bmatrix}1&0&0\\ 2&1&0\\ 3&2&1\\ \end{bmatrix}
\\
$$
Prove A = LU
$$
\\
LU = A \ \rightarrow \begin{bmatrix}1&0&0\\ 2&1&0\\ 3&2&1\\ \end{bmatrix} \ \begin{bmatrix}1&1&2\\ 0&-1&-4\\ 0&0&3\\ \end{bmatrix} = \begin{bmatrix}1&1&2\\ 2&1&0\\ 3&1&1\\ \end{bmatrix}
$$

Write an R function to factorize a square matrix A into 
LU or LDU, whichever you prefer. Please submit your response in an R Markdown document using our class naming convention,
e.g. LFulton_Assignment2_PS2.png

You donâ€™t have to worry about permuting rows of A and you can assume that A is less than 5x5, if you need to hard-code
any variables in your code. If you doing the entire assignment in R, then please submit only one markdown document for 
both the problems.

```{r}
func_LUD = function(matrix){
  # Check t see if the matrix is a 5x5 matrix or bigger.
  if (nrow(matrix) >=5){
    return("Matrix dimensions are greater than 4 for this exercise")
  }
  
  # Check to see if the matrix is Not a square matrix.
  if (is.square.matrix(matrix) == FALSE){
    return("Not a square matrix")
  }
   
  n = nrow(matrix)[1] # get the number of rows in the matix.
  L = diag(n) # create an identity matrix of same size as our matrix and set L for Lower Triangular Matrix
  
  f = 0 # initialization variable.
  
  while (f <= dim(matrix)[1]){
    f = f + 1
    i = f
    j = f
  
  # Calculate the Lower triangular matrix
  while (i <= dim(matrix)[1] - 1) {
    c = matrix[i + 1,j]/matrix[j,j]
    matrix[i+1,] = matrix[i+1,]-c*matrix[j,]
    L[i+1,j] = c
    i = 1+i
  }
  }
  return(L)
  
}
```

```{r}
# c_matrix = matrix(c(7,8,9,1,2,3,4,5,6), 3, 3)
c_matrix = matrix(c(1,2,3,1,1,1,2,0,1), nrow=3)
c_matrix
```

```{r}
func_LUD(c_matrix)
```

```{r}
lu.decomposition(c_matrix)
```